[TOC]

# 多模态活动预测系统 - 专利文档

## 1.预测结果

### 1.1指标结果

#### 表1 静态预测实验结果

|          | **MAE(↓)** |
|----------|---------|
| **user_sum（活跃用户总量）** | **3008.3733** |
| **oc_sum（订单总数）** | **2782.225** |

注：↓表示数值越小越好。静态预测目标为user_sum（用户总数）和oc_sum（订单总数），目标值最大值20w+。

#### 表2 动态预测不同输入输出长度实验结果（以天为步长）

## 表1 动态预测不同输入输出长度组合实验结果

| **输入→输出** | **uc（活跃用户量）** |            | **oc（订单量）** |            |
|---------------|---------------------|------------|------------------|------------|
|               | **MAE(↓)**          | **MSE(↓)** | **MAE(↓)**       | **MSE(↓)** |
| **7→3**       | 76.2345             | 9456.7823  | 85.3421  | 11345.6789 |
| **7→7**       | 90.0744             | 13847.3891 | **75.2156** | 9862.7692 |
| **14→7**      | **71.5074**         | 8936.2574  | 79.1234 | 10862.8912 |
| **14→14**     | 94.7021             | 16834.6789 | 82.4567  | 10784.5623 |
| **21→7**      | 83.2779      | 11234.5678 | 88.7654  | 12334.1245 |

注：表中"输入长度→输出长度"表示使用的历史数据天数和预测未来天数。动态预测目标为uc（用户量）和oc（订单量）。

### 1.2可视化结果

#### 静态预测结果可视化

![image-20250819205657069](/Users/tal/Library/Application Support/typora-user-images/image-20250819205657069.png)

#### 动态预测结果可视化（输入14天输出7天）

![image-20250819205731814](/Users/tal/Library/Application Support/typora-user-images/image-20250819205731814.png)

![image-20250819205726171](/Users/tal/Library/Application Support/typora-user-images/image-20250819205726171.png)

![image-20250819205709361](/Users/tal/Library/Application Support/typora-user-images/image-20250819205709361.png)

## 2.详细训练流程图

```mermaid
graph TD
    A[train_new.py主训练入口] --> B[configs/config.yaml配置文件加载]
    B --> C[参数转换convert_config_to_args]
    C --> D[utils/data_processor.py数据处理模块]
    D --> E[数据源文件activity_order_independent_id和all_activities_attributes和activities_duration]
    E --> F[UnifiedDataset PyTorch统一数据集]
    F --> G[models/WXM.py主模型初始化]
    G --> H[任务类型判断]
    H --> H1[static到StaticExp静态预测实验]
    H --> H2[dynamic到DynamicExp动态预测实验]
    H1 --> I[utils/static_exp.py静态实验执行]
    H2 --> J[utils/dynamic_exp.py动态实验执行]
    I --> K[results/static静态预测结果]
    J --> L[results/dynamic动态预测结果]
```

## 3.数据处理详细流程

```mermaid
graph TD
    A[原始订单数据activity_order_independent_id_csv] --> B[文件验证大小检查必需列检查编码处理]
    B --> C[数据聚合时间重采样统计计算缺失值填充]
    C --> D[聚合输出activity_order_independent_id_freq和activities_duration_freq_csv]
    
    E[活动属性数据all_activities_attributes_threshold_csv] --> F[属性数据合并去除重复列左连接合并]
    D --> F
    F --> G[数据排序按activity_start_time排序]
    G --> H[输出数据集包含所有特征的活动数据集]
```

## 4.数据流向图

```mermaid
graph TD
    A[原始订单数据activity_order_independent_id] --> D[DataProcessor数据预处理]
    B[活动属性数据all_activities_attributes_csv] --> D
    C[历史活动数据activities_duration_csv] --> D
    D --> E[UnifiedDataset PyTorch数据集]
    E --> F[RevIN层可逆归一化]
    E --> G[WXM模型主模型]
    F --> I[StaticExp静态预测]
    G --> I
    F --> J[DynamicExp动态预测]
    G --> J
    
    E --> H[DDN归一化模块]
    H --> J
    
    I --> K[静态预测结果results/static]
    J --> L[动态预测结果results/dynamic]
```

